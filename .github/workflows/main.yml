name: Streamlit Pinger

on:
  schedule:
    - cron: "*/10 * * * *"
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    timeout-minutes: 5

    steps:
      - name: Ping Streamlit app
        shell: bash
        run: |
          set -euo pipefail

          URL="https://ai-training-aid-8b84t27ivzumzycyzwd6tv.streamlit.app"

          echo "Time (UTC): $(date -u)"
          echo "URL: $URL"

          STATUS=$(curl -sS \
            -A "Mozilla/5.0" \
            --connect-timeout 10 \
            --max-time 20 \
            --max-redirs 5 \
            -o /dev/null \
            -w "%{http_code}" \
            "$URL" || echo "000")

          echo "HTTP status: $STATUS"

          case "$STATUS" in
            200|301|302|303|307|308)
              exit 0
              ;;
            *)
              exit 1
              ;;
          esac
